<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Explore the beauty of the Quran and enhance your Arabic skills on Quran Type! Type and explore Quranic text to improve your Arabic writing, reading, and vocabulary. Unlock the beauty of the language while deepening your understanding of the sacred Quran.">
    <title>Quran Type +</title>

    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.0/css/bulma.min.css">
    <!-- Пользовательские стили поверх Bulma -->
    <link rel="stylesheet" href="src/css/styles.css">

    <!-- Toastify -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <!-- Пользовательские скрипты -->
    <script type="module" src="src/js/logic.js" defer></script>

    <!-- Шрифты -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Noto+Naskh+Arabic&display=swap" rel="stylesheet">

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="public/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="public/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="public/icons/favicon-16x16.png">
    <link rel="mask-icon" href="public/icons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="public/icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="public/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

</head>
<body>
    <section class="section pt-4 pb-4">
        <nav class="level">
            <!-- Left side -->
            <div class="level-left">
                <div class="level-item">
                    <h1 class="title logo-title">Quran Type +</h1>
                </div>
            </div>

            <!-- Right side -->
            <div class="level-right">
                <div class="level-item">
                    <!-- Search -->
                    <div class="field has-addons">
                        <div class="control">
                            <label for='Surah-selection-input' class="is-sr-only">Enter Surah and Verse:</label>
                            <input class="input" type="search" placeholder="Enter Surah:Ayah" aria-label="Search Quran"
                                   autocomplete="off" id="Surah-selection-input">
                        </div>
                        <div class="control">
                            <button class="button is-primary" id="Display-Surah-button">
                                Display
                            </button>
                        </div>
                    </div>
                </div>
                <div class="level-item">
                    <!-- Theme Toggle (оставляем только изображения внутри кнопки) -->
                   <button class="button is-text image-button mr-2" id="dark-mode-toggle" aria-label="Toggle theme" title="Сменить тему"> <!-- Добавляем is-text, image-button, title -->
                       <img src="public/images/LanternLight.svg" alt="Light Mode" id="light-mode-icon" class="theme-icon button-icon">
                       <img src="public/images/LanternDark.svg" alt="Dark Mode" id="dark-mode-icon" class="theme-icon button-icon" style="display: none;">
                   </button>
                    <!-- Кнопка Изменить Суру -->
                    <button class="button is-text image-button" id="change-surah-button" aria-label="Изменить Суру" title="Изменить Суру">
                        <img src="public/images/MenuLight.svg" alt="Menu" id="light-menu-icon" class="button-icon">
                        <img src="public/images/MenuDark.svg" alt="Menu" id="dark-menu-icon" class="theme-icon button-icon">
                    </button>
                </div>
            </div>
        </nav>
    </section>

    <!-- ИЗМЕНЕНО: Добавлены data-tab атрибуты и начальное состояние -->
    <section class="section pt-4 pb-4 is-hidden" id="surah-selection-section">
        <div class="container">
            <div class="tabs is-centered is-boxed">
                <ul>
                    <li class="is-active" data-tab="surah"><a>Surah</a></li>
                    <li data-tab="juz"><a>Juz</a></li>
                    <li data-tab="hizb"><a>Hizb</a></li>
                    <li data-tab="rub"><a>Rub'</a></li>
                    <li data-tab="page"><a>Page</a></li>
                </ul>
            </div>
            <!-- ИЗМЕНЕНО: Добавлен класс .tab-content для всех контейнеров -->
            <div id="tab-content-surah" class="tab-content">
                <!-- СУЩЕСТВУЮЩИЙ КОНТЕЙНЕР ТАБЛИЦЫ СУР -->
                <div class="table-container">
                    <table class="table is-bordered selection-table is-striped is-narrow is-hoverable is-fullwidth" id="surah-selection-table"> <!-- ДОБАВЛЕНО: selection-table class -->
                        <thead>
                            <tr>
                              <th rowspan="2">№</th>
                              <th rowspan="2">سورة</th>
                              <th rowspan="2">Surah</th>
                              <th rowspan="2">Period</th>
                              <th rowspan="2">Ayah</th>
                              <th colspan="5">Normal Mode</th>
                              <th colspan="5">Blind Mode</th>
                            </tr>
                            <tr>
                              <th>Time</th><th>Errors</th><th>Score</th><th>Rank</th><th></th> <!-- Normal -->
                              <th>Time</th><th>Errors</th><th>Score</th><th>Rank</th><th></th> <!-- Blind -->
                            </tr>
                        </thead>
                        <tbody id="surah-selection-tbody">
                            <!-- Строки для Сур будут добавлены динамически -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ИЗМЕНЕНО: Добавлен is-hidden и класс .tab-content, класс .selection-table -->
            <div id="tab-content-juz" class="tab-content is-hidden">
                <div class="table-container">
                    <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth selection-table" id="juz-selection-table"> <!-- ДОБАВЛЕНО: selection-table class -->
                        <thead>
                            <tr>
                                <th rowspan="2">Juz №</th>
                                <th colspan="5">Normal Mode</th>
                                <th colspan="5">Blind Mode</th>
                              </tr>
                              <tr>
                                <th>Time</th><th>Errors</th><th>Score</th><th>Rank</th><th></th> <!-- Normal -->
                                <th>Time</th><th>Errors</th><th>Score</th><th>Rank</th><th></th> <!-- Blind -->
                              </tr>
                        </thead>
                        <tbody id="juz-selection-tbody">
                             <!-- Строки для Джузов будут добавлены динамически -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ИЗМЕНЕНО: Добавлен is-hidden и класс .tab-content, класс .selection-table -->
            <div id="tab-content-hizb" class="tab-content is-hidden">
                <div class="table-container">
                     <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth selection-table" id="hizb-selection-table"> <!-- ДОБАВЛЕНО: selection-table class -->
                        <thead>
                            <tr>
                                <th rowspan="2">Hizb №</th>
                                <th colspan="5">Normal Mode</th>
                                <th colspan="5">Blind Mode</th>
                              </tr>
                              <tr>
                                <th>Time</th><th>Errors</th><th>Score</th><th>Rank</th><th></th> <!-- Normal -->
                                <th>Time</th><th>Errors</th><th>Score</th><th>Rank</th><th></th> <!-- Blind -->
                              </tr>
                        </thead>
                        <tbody id="hizb-selection-tbody">
                            <!-- Строки для Хизбов будут добавлены динамически -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ИЗМЕНЕНО: Добавлен is-hidden и класс .tab-content, класс .selection-table -->
            <div id="tab-content-rub" class="tab-content is-hidden">
                 <div class="table-container">
                     <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth selection-table" id="rub-selection-table"> <!-- ДОБАВЛЕНО: selection-table class -->
                        <thead>
                             <tr>
                                <th rowspan="2">Rub' №</th>
                                <th colspan="5">Normal Mode</th>
                                <th colspan="5">Blind Mode</th>
                              </tr>
                              <tr>
                                <th>Time</th><th>Errors</th><th>Score</th><th>Rank</th><th></th> <!-- Normal -->
                                <th>Time</th><th>Errors</th><th>Score</th><th>Rank</th><th></th> <!-- Blind -->
                              </tr>
                        </thead>
                        <tbody id="rub-selection-tbody">
                             <!-- Строки для Руб аль Хизб будут добавлены динамически -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ИЗМЕНЕНО: Добавлен is-hidden и класс .tab-content, класс .selection-table -->
             <div id="tab-content-page" class="tab-content is-hidden">
                 <div class="table-container">
                    <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth selection-table" id="page-selection-table"> <!-- ДОБАВЛЕНО: selection-table class -->
                         <thead>
                            <tr>
                                <th rowspan="2">Page №</th>
                                <th colspan="5">Normal Mode</th>
                                <th colspan="5">Blind Mode</th>
                              </tr>
                              <tr>
                                <th>Time</th><th>Errors</th><th>Score</th><th>Rank</th><th></th> <!-- Normal -->
                                <th>Time</th><th>Errors</th><th>Score</th><th>Rank</th><th></th> <!-- Blind -->
                              </tr>
                        </thead>
                        <tbody id="page-selection-tbody">
                            <!-- Строки для Страниц будут добавлены динамически -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Оберните существующий основной контент в этот div -->
    <div id="main-typing-section">

    <section class="section pt-2 pb-5">
        <div class="container has-text-centered">
            <!-- Surah Details -->
            <div id="Surah-details" class="mb-4">
                <div id="Surah-name" class="subtitle is-4"></div>
                <div id="Basmallah" class="is-size-5"></div>
            </div>

            <!-- Quran Text Container -->
            <div id="Quran-container" class="content has-text-right mb-5" dir="rtl">
                <!-- Spans will be injected here by JS -->
            </div>
            <!-- Hidden Container for No-Tashkeel text -->
            <div id="noTashkeelContainer" style="display: none;"></div>

            <!-- Input and Controls Container -->
            <div id="Quran-input-controls-container" class="is-flex is-flex-direction-column is-align-items-center">
                 <!-- Input Row -->
                <div class="field is-grouped is-grouped-centered is-fullwidth mb-4" id="Quran-input-container">
                    <div class="control">
                        <button id="hideAyahsButton" class="button is-primary is-medium">Hide Ayahs</button>
                    </div>
                    <div class="control">
                        <label for='inputField' class="is-sr-only">Type the verses from the Quran shown:</label>
                        <input class="input is-medium" autocomplete="off" id="inputField" dir="rtl">
                    </div>
                </div>

                <!-- Repetition Controls Row -->
                <div id="repetitionControlsRow" class="field is-grouped is-grouped-centered is-grouped-multiline" dir="ltr"> <!-- Force LTR for controls -->
                    <!-- Ayah Repetition -->
                    <div class="control">
                        <div class="field has-addons" id="wordRepetitionContainer">
                            <div class="tags has-addons">
                                <span class="tag">Repeat Ayah:</span>
                                <input type="number" id="repeatCountInput" name="repeatCount" min="1" value="1" class="input is-small repetition-input">
                                <span class="tag">times</span>
                            </div>
                        </div>
                    </div>
                    <!-- Word Repetition -->
                    <div class="control">
                        <div class="field has-addons" id="wordRepetitionContainer">
                            <div class="tags has-addons">
                                <span class="tag">Repeat Word:</span>
                                <input type="number" id="wordRepeatCountInput" name="wordRepeatCount" min="1" value="1" class="input is-small repetition-input">
                                <span class="tag">times</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

    <footer class="footer pt-5 pb-5">
        <div class="content has-text-centered">
            <div class="level">
                 <!-- Error Counter -->
                <div class="level-item has-text-centered">
                    <div id="errorCounterContainer">
                        <span id="errorCountLabel" class="has-text-weight-bold">Errors: </span>
                        <span id="errorCountDisplay" class="has-text-weight-bold">0</span>
                    </div>
                </div>
                <!-- Timer -->
                <div class="level-item has-text-centered">
                    <div id="timerContainer">
                        <span id="timerLabel" class="has-text-weight-bold">Time: </span>
                        <span id="timerDisplay" class="has-text-weight-bold">00:00:00.000</span>
                    </div>
                </div>
                <!-- ДОБАВЛЕНО: Adjusted CPM -->
                <div class="level-item has-text-centered">
                    <div id="acpmContainer">
                        <span id="acpmLabel" class="has-text-weight-bold">aCPM: </span>
                        <span id="acpmDisplay" class="has-text-weight-bold">-</span>
                    </div>
                </div>
                <!-- ДОБАВЛЕНО: Score -->
                <div class="level-item has-text-centered">
                    <div id="scoreContainer">
                        <span id="scoreLabel" class="has-text-weight-bold">Score: </span>
                        <span id="scoreDisplay" class="has-text-weight-bold">-</span>
                    </div>
                </div>
                <!-- ДОБАВЛЕНО: Rank -->
                <div class="level-item has-text-centered">
                    <div id="rankContainer">
                        <span id="rankLabel" class="has-text-weight-bold">Rank: </span>
                        <span id="rankDisplay" class="has-text-weight-bold">-</span>
                    </div>
                </div>
                 <!-- Links -->
                 <div class="level-item has-text-centered">
                    <a href="https://api-docs.quran.com/docs/category/quran.com-api" target="_blank" class="footer-link">Quran Api source</a>
                 </div>
                 <div class="level-item has-text-centered">
                     <a href="https://qurantype.com" target="_blank" class="footer-link">Original Website</a>
                 </div>
            </div>
        </div>
    </footer>
</body>
</html>